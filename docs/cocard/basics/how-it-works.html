<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Wie funktioniert Cocard? :: Cocard</title>
    <link rel="prev" href="../user/common.html">
    <link rel="next" href="interfaces/soap.html">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">Cocard</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Suche ...">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div class="abstand">
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
           <a class="navbar-item" href="../../devnotes/index.html">DevNotes</a>
          <div class="navbar-item dark">Dokumentation</div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="cocard" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Dokumentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Cocard</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/dashboard.html">Dashboard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/common.html">Allgemeines zur Oberfläche</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="how-it-works.html">Wie funktioniert Cocard?</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="interfaces/soap.html">SOAP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="interfaces/rmi.html">RMI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="interfaces/koco-webapi.html">KoCoBox WebAPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="interfaces/ticlient-rest.html">RISE TI-Client REST-API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/conditions.html">Zustände</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/logs.html">Event Logs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/acknowledges.html">Notizen und Acknowledges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/ti-lagebild.html">TI-Lagebild</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/verify-pin.html">PIN-Verifizierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/workplaces.html">Arbeitsplätze</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/tags.html">Tags</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../connector/connector.html">Konnektor</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connector/connector-edit.html">Konnektor anlegen/bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connector/connector-autoreboot.html">Automatischer Reboot</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ct/card-terminal.html">Kartenterminal</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/card-terminal-edit.html">Kartenterminal anlegen/bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/card-terminal-health-check.html">Health-Check</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/idle-messages-edit.html">Ruhebildschirme setzen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/duck-terminal.html">Kartenterminal über IP-Adresse prüfen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/smcb-remote-pin.html">Remote PIN für SMC-B Karten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/ct-arp-check.html">ARP-Abgleich</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../card/card.html">Karte</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../card/card-new.html">Karte anlegen/bearbeiten</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Administration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../admin/contexts.html">Kontexte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../admin/locations.html">Standorte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../admin/networks.html">Netzwerke</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../admin/operational_states.html">Betriebszustände</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../admin/jobs.html">Jobverwaltung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../admin/authorities.html">Berechtigungen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../admin/client-certificates.html">Client-Zertifikate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../admin/ldap-authentication.html">LDAP-Authentifikation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ti-client/index.html">TI-Client (RISE TI Gateway)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ti-client/activate-api.html">REST-API aktivieren</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../changelog.html">Changelog</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installation/index.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installation/podman/quickstart.html">Quickstart: podman pods</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../first-steps.html">Erste Schritte</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installation/podman/podman-compose.html">Quickstart: docker-compose</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../first-steps.html">Erste Schritte</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/podman/podman-systemd.html">Systemd und Quadlets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/podman/reverse-proxy.html">Reverse Proxy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Konfiguration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation/configuration.html">Standard-Konfiguration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation/cocard_yml.html">Erweiterte Konfiguration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/checkmk.html">CheckMK Integration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Dokumentation</span>
    <span class="version">default</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../devnotes/index.html">DevNotes</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devnotes/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Dokumentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Dokumentation</a></li>
    <li><a href="../index.html">Cocard</a></li>
    <li><a href="how-it-works.html">Wie funktioniert Cocard?</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Wie funktioniert Cocard?</h1>
<div class="sect1">
<h2 id="_verwendete_schnittstellen"><a class="anchor" href="#_verwendete_schnittstellen"></a>Verwendete Schnittstellen</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cocard verwendet verschiedene Schnittstellen zur Informationsgewinnung und Steuerung der TI-Komponenten:</p>
</div>
<table class="tableblock frame-all grid-all fit-content">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API</th>
<th class="tableblock halign-left valign-top">Beschreibung</th>
<th class="tableblock halign-left valign-top">Für</th>
<th class="tableblock halign-left valign-top">Spezifikation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SOAP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Offizielle, von der Gematik definierte Schnittstelle zur für Primärsystemen zu den lokalen TI-Komponenten über den Konnektor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alle von der Gematik zertifizierten Konnektoren, Kartenterminals und Karten (Cocard: primär SMC-B und SMC-KT)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://gemspec.gematik.de/docs/gemSpec/gemSpec_Kon/latest/">Gematik gemSpec_Kon</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RMI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote-Management-Interface für Kartenterminals</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nur Kartenterminals Orga6141 ab Firmware v3.9.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://worldline.com/content/dam/worldline/local/de-de/documents/Remote-Management-Interface-ORGA-6141-online.pdf">RMI Orga6141-online</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KoCoBox WebAPI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undokumentiertes WebAPI der KoCoBox-Konnektoren. Manges Dokumentation ist die Funktion bei Firmwareupdates nicht gesichert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KoCoBox Einbox-Konnektoren mit Firmware v5.5.16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[-]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RISE TI-Client REST-API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REST-API für den TI-Client von RISE. Darüber ist auch ein Zugriff auf den Konnektor möglich</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nur bei Einsatz des RISE-TI-Clients mit KT-Proxys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Zugang zur geschützten Online-Dokumentation bitte bei RISE erfragen</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Die primäre Schnittstelle ist SOAP. Cocard erreicht darüber alle zugelassenen Konnektoren, Kartenterminals und Karten (SMC-B, SMC-KT). Cocard lässt sich daher in allen lokalen TI-Umgebungen einsetzen, auch wenn die anderen Schnittstellen nicht genutzt werden können.</p>
</div>
<div class="paragraph">
<p>RMI, KoCoBox WebAPI und RISE TI-Client REST-API erweitern den Funktionsumfang von Cocard zum Teil erheblich, sind aber nur nutzbar, wenn die jeweiligen Komponenten auch zum Einsatz kommen. Die wesentlichen Funktionen von Cocard wie Informationsgewinnung, Monitoring und Inventarisierung sind aber nicht auf diese spezialisierten Schnittstellen angewiesen.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_informationsgewinnung"><a class="anchor" href="#_informationsgewinnung"></a>Informationsgewinnung</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Die drei primären Jobs für die Informationsgewinnung sind:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Konnektor: <code>GetResourceInformation</code> (alle 3min)</p>
</li>
<li>
<p>Kartenterminals: <code>GetCardTerminals</code> (alle 5min)</p>
</li>
<li>
<p>Karten: <code>GetCards</code> (alle 7min)</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_konnektor"><a class="anchor" href="#_konnektor"></a>Konnektor</h3>
<div class="paragraph">
<p>Mit <code>GetResourceInformation</code> fragt Cocard beim Konnektor einmal den Verbindungszustand zur TI und aktuelle Betriebszustände wie <code>EC_Time_Sync_Not_Successful</code> ab. Aktuelle Betriebszustände werden im Dashboard unter <em>Ereignisse</em> aufgeführt.</p>
</div>
<div class="paragraph">
<p>Zur Nutzung der SOAP-Schnittstelle gehört das Service-Directory, dort steht kurz gesagt welche Abfragen ein Primärsystem stellen kann und wie diese zu formatieren sind. Bei der ersten Inbetriebnahme holt man die sogenannte SDS-Datei <code>connector.sds</code> manuell per Button, nach Einrichtung erfolgt die Abfrage der SDS-Datei einmal pro Tag. Die Datei wird nur bei Firmware-Updates aktualisiert.</p>
</div>
<div class="paragraph">
<p>Zur Abfrage der Laufzeit des Konnektor-Zertifikates nutzt Cocard den Aufruf <code>CheckCertificateExpiration</code>. Das ist die einzige Möglichkeit, über die SOAP-Schnittstelle an die ICCSN und die Laufzeit des Zertfikates zu kommen. Die Abfrage erfolgt ebenfalls einmal pro Tag.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Manche Konnektoren (z.B. RISE vKonn) liefern einen Fehler bei <code>CheckCertificateExpiration</code>, wenn ein HBA steckt. Ursache ist eine nicht ganz eindeutige Spezifikation des SOAP-Aufrufes, die die Hersteller unterschiedlich interpretieren.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_kartenterminals"><a class="anchor" href="#_kartenterminals"></a>Kartenterminals</h3>
<div class="paragraph">
<p>Cocard nutzt den Aufruf <code>GetCardTerminals</code> mandantenweit, der Arbeitsplatz in dem Kontext spielt daher keine Rolle. Wichtig ist daher nur, dass die Kartenterminals über den im Kontext verwendeten Mandanten erreichbar sind. Idealerweise verwendet man einen separaten Kontext für Cocard wie <code>cocard - cocard - Konnektor</code> (Mandant - Clientsystem - Arbeitsplatz) und ordnet alle Kartenterminals dem Arbeitsplatz zu (hier: <code>Konnektor</code>). Wenn der Arbeitsplatz dann mit dem Mandanten (hier: <code>cocard</code>) verknüpft wird, bekommt Cocard alle Kartenterminals zu sehen. Die Funktion des Kontextes wird in <a href="interfaces/soap.html" class="xref page">SOAP</a> ausführlicher erklärt.</p>
</div>
<div class="paragraph">
<p>Zur Pflege von Kontexten in Cocard siehe <a href="../admin/contexts.html" class="xref page">Kontexte</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_karten"><a class="anchor" href="#_karten"></a>Karten</h3>
<div class="paragraph">
<p>Mit dem Aufruf <code>GetCards</code> mandantenweit erfolgt die Abfrage von SMC-Bs und SMC-KTs ebenfalls mandantenweit. HBAs werden ebenfalls inventarisiert, wenn diese bei der Abfrage gerade in einem Terminal stecken.</p>
</div>
<div class="paragraph">
<p>Für die SMC-KTs gelten die gleichen Regeln wie für die Kartenterminals. SMC-Bs dagegen müssen am Konnektor explizit dem Mandanten zugeordnet werden, den Cocard im Kontext der Abfrage benutzt. Andernfalls "sieht" Cocard die SMC-Bs nicht.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../user/common.html">Allgemeines zur Oberfläche</a></span>
  <span class="next"><a href="interfaces/soap.html">SOAP</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <span>Wolfgang Barth (C) 2024-2026</span>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/medium-zoom.min.js"></script>
<script>mediumZoom('img:not(.copy-icon');</script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/vendor/lunr-languages.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
