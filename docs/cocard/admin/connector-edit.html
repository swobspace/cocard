<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Konnektor anlegen/bearbeiten :: Cocard</title>
    <meta name="generator" content="Antora 3.1.9">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">Cocard</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div class="abstand">
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
          <div class="navbar-item dark">Cocard</div>
           <a class="navbar-item" href="../../devnotes/index.html">DevNotes</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="cocard" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Cocard</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Cocard</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/dashboard.html">Dashboard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/common.html">Allgemeines zur Oberfläche</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/conditions.html">Zustände</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/logs.html">Event Logs</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/acknowledges.html">Acknowledges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/ti-lagebild.html">TI-Lagebild</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/verify-pin.html">PIN-Verifizierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/workplaces.html">Arbeitsplätze</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Administration</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="connector-edit.html">Konnektor anlegen/bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="card-terminal-edit.html">Kartenterminal anlegen/bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="card-new.html">Karte anlegen/bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="contexts.html">Kontexte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="locations.html">Standorte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="networks.html">Netzwerke</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="operational_states.html">Betriebszustände</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jobs.html">Jobverwaltung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="authorities.html">Berechtigungen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="smcb-remote-pin.html">Remote PIN für SMC-B Karten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="client-certificates.html">Client-Zertifikate importieren</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installation/index.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installation/podman/quickstart.html">Quickstart: podman pods</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../first-steps.html">Erste Schritte</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installation/podman/podman-compose.html">Quickstart: docker-compose</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../first-steps.html">Erste Schritte</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/podman/podman-systemd.html">Systemd und Quadlets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/podman/reverse-proxy.html">Reverse Proxy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/configuration.html">Konfiguration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/checkmk.html">CheckMK Integration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Cocard</span>
    <span class="version">default</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Cocard</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../devnotes/index.html">DevNotes</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devnotes/index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Cocard</a></li>
    <li>Administration</li>
    <li><a href="connector-edit.html">Konnektor anlegen/bearbeiten</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Konnektor anlegen/bearbeiten</h1>
<div class="sect1">
<h2 id="_ohne_tls_ohne_authentifikation"><a class="anchor" href="#_ohne_tls_ohne_authentifikation"></a>Ohne TLS, ohne Authentifikation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Für die Anlage eines Konnektors in Cocard genügt zunächst die IP-Adresse, alle anderen Felder sind optional. <code>Admin-URL</code> und <code>SDS-URL</code> werden dabei automatisch generiert, man kann sie später manuell abändern, wenn der vorbelegte Wert nicht zutrifft.</p>
</div>
<div class="paragraph">
<p>Nach dem erstmaligen Speichern ruft man das Bearbeitungsformular ein zweites Mal auf und weist dem Konnektor einen oder mehrere <a href="contexts.html" class="xref page">Kontexte</a> zu. Die Abfrage von Kartenterminals und Karten erfolgt mandantenweit, d.h. der Konnektor liefert alle Kartenterminals und alle Karten zurück, die im Infomodell dem Mandanten zugewiesen sind.</p>
</div>
<div class="paragraph">
<p>Idealerweise konfiguriert man alle Konnektoren so, dass man mit einem Default-Kontext alle Konnektordaten, Kartenterminals und Karten abfragen kann. In diesem Falle genügt ein einziger Kontext. Nur wenn es Kartenterminals oder Karten gibt, die man über diesen Kontext nicht abfragen kann, sind weitere Kontexte erforderlich.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/connector/connector-edit-http.png" alt="connector edit http"></span></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Konnektor: Felder</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feld</th>
<th class="tableblock halign-left valign-top">Beschreibung</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kurzbezeichnung des Konnektors, wird in allen Übersichten angezeigt</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Admin-URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL zum Aufruf der Web-Administration des Konnektors</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SDS-URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Abruf der SDS-Informationen vom Konnektor. Die Information ist kritisch für Cocard, ohne korrekte Daten ist Cocard nicht weiter nutzbar. Bei der Erstanlage und nach jeder Änderung sollte daher immer nach dem Speichern einmal die <b class="button">Abfrage SDS</b> manuell ausgeführt werden.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Beschreibung</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Freitextfeld für die Dokumentation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standorte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Einem Konnektor können mehrere Standorte zugewiesen werden. Ob man Standorte für die Dokumentation, wo der Konnektor steht, oder zur Dokumentation für die Standorte, die der Konnektor bedient, bleibt dem Admin überlassen.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vertragsnummer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Geschütztes Feld für die Vertragsnummer zu Dokumentationszwecken.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seriennummer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seriennummer des Konnektors zur Dokumentation</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS verwenden</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLS aktivieren ja/nein</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentifikation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Keine</code>, <code>Client-Zertifikat</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="client-certificates.html" class="xref page">Client-Zertifikate</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ein oder mehrere Client-Zertifikate für die Authentifikation am Konnektor</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kontexte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">siehe <a href="contexts.html" class="xref page">Kontexte</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Nach dem Speichern mit einem zugewiesenen Kontext betätigt man einmal den Button <b class="button">Abfrage SDS</b>. Damit erhält Cocard die Informationen über die einzelnen Services und Endpunkte, die für die Abfrage von Informationen per SOAP über die von der Gematik definierten Funktionen erforderlich sind. Cocard aktualisiert diese Information einmal pro Tag danach automatisch.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/connector/connector-fetch-sds-button.png" alt="connector fetch sds button"></span></p>
</div>
<div class="paragraph">
<p>Mit der Information aus dem Service Directory Service (SDS) kann Cocard Kartenterminals und Karten abfragen. Die Abfrage erfolgt dabei mehrmals pro Stunde (bis auf das SDS selbst). Details zu den Zeitinterfallen sind in <a href="jobs.html" class="xref page">Jobverwaltung</a> beschrieben.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mit_tls_mit_authentifikation_per_client_zertifikat"><a class="anchor" href="#_mit_tls_mit_authentifikation_per_client_zertifikat"></a>Mit TLS, mit Authentifikation per Client-Zertifikat</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Für eine sichere Kommunikation zwischen Client (Primärsystem, z.B. Cocard) und dem Konnektor aktiviert man TLS und die Authentifikation per Client-Zertifikat. Die nachstehende Abbildung zeigt die Einstellungen für die Kocobox v5.1.8. Für manche Szenarien wie die Komfortsignatur ist die sichere Kommunikation zwingend erforderlich.</p>
</div>
<div class="paragraph">
<div class="title">TLS und Authentifikation auf der Kocobox aktivieren: <span class="menuseq"><b class="menu">Verwaltung</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Clientsysteme</b></span></div>
<p><span class="image"><img src="../_images/connector/kocobox-tls-auth-client.png" alt="kocobox tls auth client"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Cocard kann sich derzeit nur über Client-Zertifikate authentifizieren, eine Authentifikation via User/Passwort ist nicht möglich und ist zur Zeit auch nicht geplant.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Für die sichere Kommunikation sind folgende Einstellungen am Konnektor erforderlich:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SDS-URL mit https eintragen</p>
</li>
<li>
<p>Schalter <em>TLS verwenden</em> aktivieren</p>
</li>
<li>
<p>Authentifikation: <em>Client-Zertifikat</em> auswählen</p>
</li>
<li>
<p><a href="client-certificates.html" class="xref page">Client-Zertifikat</a> hinterlegen, passen zum Kontext.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Nach dem Speichern holt man manuell einmal die SDS-Informationen mit dem Button <b class="button">Abfrage SDS</b>.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/connector/connector-edit-https-cert.png" alt="connector edit https cert"></span></p>
</div>
<div class="sect2">
<h3 id="_welche_client_zertifikate_müssen_hinterlegt_werden"><a class="anchor" href="#_welche_client_zertifikate_müssen_hinterlegt_werden"></a>Welche Client-Zertifikate müssen hinterlegt werden?</h3>
<div class="paragraph">
<p>Der Konnektor benötigt ein <a href="client-certificates.html" class="xref page">Client-Zertifikat</a> für jedes Clientsystem, das von Cocard bei diesem Konnektor benutzt wird. Das sind einmal die Clientsysteme, die der Konnektor selbst in seinem zugewiesenen Kontexten verwendet, hier im Beispiel <code>intern</code>. Wenn jetzt für die PIN-Prüfung/PIN-Verifizierung bei einer Karte weitere Kontexte mit anderen Clientsystemen zum Einsatz kommen, müssen diese Zertifikate hier zusätzlich hinterlegt werden.</p>
</div>
<div class="paragraph">
<p>Beispiel:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Der Konnektor benutzt den administrativen Kontext <code>Service_Mandant - intern - Konnektor</code>, weil er damit alles erreichen kann, auch wenn der Kontext von Primärsystemen so nicht genutzt wird.</p>
</li>
<li>
<p>Eine SMC-B-Karte benutzt den produktiven Kontext <code>Ein1 - iMedOne - Konnektor</code> für das Primärsystem <code>iMedOne</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Im Konnektor hinterlegt man nun das Client-Zertifikat für das Clientsystem <code>intern</code> und das Client-Zertifikat für das Clientsystem <code>iMedOne</code>.</p>
</div>
<div class="paragraph">
<p>Am Konnektor selbst muss der Kontext <code>Ein1 - iMedOne - Konnektor</code> nicht eingetragen werden, wenn hier keine zusätzlichen Kartenterminals oder Karten sichtbar werden, d.h. wenn alles schon über den <code>Service_Mandant - intern - Konnektor</code> erreichbar ist.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <span>Wolfgang Barth (C) 2024</span>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/medium-zoom.min.js"></script>
<script>mediumZoom('img:not(.copy-icon');</script>
  </body>
</html>
