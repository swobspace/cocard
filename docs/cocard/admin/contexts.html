<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kontexte :: Cocard</title>
    <link rel="prev" href="../user/logs.html">
    <link rel="next" href="../user/acknowledges.html">
    <meta name="generator" content="Antora 3.1.14">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../..">Cocard</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Suche ...">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div class="abstand">
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
           <a class="navbar-item" href="../../devnotes/index.html">DevNotes</a>
          <div class="navbar-item dark">Dokumentation</div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="cocard" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Dokumentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../index.html">Cocard</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/dashboard.html">Dashboard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/common.html">Allgemeines zur Oberfläche</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../basics/how-it-works.html">Wie funktioniert Cocard?</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../basics/interfaces/soap.html">SOAP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../basics/interfaces/rmi.html">RMI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../basics/interfaces/koco-webapi.html">KoCoBox WebAPI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../basics/interfaces/ticlient-rest.html">RISE TI-Client REST-API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/workplaces.html">Arbeitsplätze</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="client-certificates.html">Client-Zertifikate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/logs.html">Event Logs</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="contexts.html">Kontexte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/acknowledges.html">Notizen und Acknowledges</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/verify-pin.html">PIN-Verifizierung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/tags.html">Tags</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/ti-lagebild.html">TI-Lagebild</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../user/conditions.html">Zustände</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../connector/connector.html">Konnektor</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connector/connector-edit.html">Konnektor anlegen/bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../connector/connector-autoreboot.html">Automatischer Reboot</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ct/card-terminal.html">Kartenterminal</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/card-terminal-edit.html">Kartenterminal anlegen/bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/card-terminal-health-check.html">Health-Check</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/idle-messages-edit.html">Ruhebildschirme setzen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/duck-terminal.html">Kartenterminal über IP-Adresse prüfen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/smcb-remote-pin.html">Remote PIN für SMC-B Karten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ct/ct-arp-check.html">ARP-Abgleich</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../card/card.html">Karte</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../card/card-new.html">Karte anlegen/bearbeiten</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../card/read-certs.html">Kartenzertifikate lesen</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Administration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="locations.html">Standorte</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="networks.html">Netzwerke</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="operational_states.html">Betriebszustände</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="jobs.html">Jobverwaltung</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="authorities.html">Berechtigungen</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ldap-authentication.html">LDAP-Authentifikation</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../ti-client/index.html">TI-Client (RISE TI Gateway)</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../ti-client/activate-api.html">REST-API aktivieren</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../changelog.html">Changelog</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installation/index.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installation/podman/quickstart.html">Quickstart: podman pods</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../first-steps.html">Erste Schritte</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installation/podman/podman-compose.html">Quickstart: docker-compose</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../first-steps.html">Erste Schritte</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/podman/podman-systemd.html">Systemd und Quadlets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/podman/reverse-proxy.html">Reverse Proxy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Konfiguration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation/configuration.html">Standard-Konfiguration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation/cocard_yml.html">Erweiterte Konfiguration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation/checkmk.html">CheckMK Integration</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Dokumentation</span>
    <span class="version">default</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../devnotes/index.html">DevNotes</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../devnotes/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Dokumentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">default</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Dokumentation</a></li>
    <li><a href="../index.html">Cocard</a></li>
    <li><a href="contexts.html">Kontexte</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Kontexte</h1>
<div class="sect1">
<h2 id="_überblick"><a class="anchor" href="#_überblick"></a>Überblick</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Jede Anfrage an den Konnektor benötigt gemäß der Definition der Gematik einen Aufrufkontext. Der Aufrufkontext - der Einfachheit halber in Cocard nur Kontext genannt -  besteht aus dem Triplet</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Mandant - Clientsystem - Arbeitsplatz</pre>
</div>
</div>
<div class="paragraph">
<p>Der Kontext wirkt als Filter. Anfragen zu bestimmten Kartenlesegeräten oder Karten, die im Infomodell nicht die Kombination aus den drei Werten besitzen, werden abgelehnt bzw. oder das Ergebnis ist ggf. eine leere Liste. Mit aktivierter Authentifikation wird zusätzlich geprüft, ob die Anfrage unter dem Namen des Clientsystems erfolgt ist. Eine Abfrage z.B. des Kontextes <code>cocard - cocard - Konnektor</code> ist nur möglich, wenn die Authentifikation als Client <code>cocard</code> erfolgt.</p>
</div>
<div class="paragraph">
<p>Die Abfrage von Kartenterminals (<code>GetCardTerminals</code>) und Karten (<code>GetCards</code>) erfolgt mandantenweit, d.h. der Konnektor gibt eine Liste aller Kartenterminals bzw. Karten zurück, die im Infomodell dem Mandanten zugewiesen sind, unabhängig vom Clientsystem und dem Arbeitsplatz. Trotzdem müssen Clientsystem und Arbeitsplatz grundsätzlich im Infomodell des Konnektors vorhanden sein, sonst filtert der Konnektor ggf. Einträge heraus und die Liste ist unvollständig oder leer.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kontexte_in_cocard"><a class="anchor" href="#_kontexte_in_cocard"></a>Kontexte in Cocard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Das
<a href="https://gemspec.gematik.de/docs/gemSpec/gemSpec_Kon/latest/#TIP1-A_4522">Konnektor-Informationsmodell der Gematik PIC_Kon_100</a> ist recht komplex aufgebaut und besteht aus vielen paarweisen oder Dreierbeziehungen. Ein Kontext in Cocard besteht dagegen aus einem festen Triplet <code>Mandant - Clientsystem - Arbeitsplatz</code>. Die in Cocard gewählte Kombination muss entsprechend im Konnektor-Infomodell konfiguriert sein.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="../_images/context/context-edit.png" alt="context edit"></span></p>
</div>
<div class="paragraph">
<p>Neben den drei Angaben Mandant, Clientsystem gibt die Möglichkeit, eine kurze Beschreibung anzugeben, die später eine Identifizierung des Kontextes erleichtert, etwa den Namen einer Institutsambulanz, wenn als Mandant nur eine wenig sprechende Betriebsstättennummer verwendet wird.</p>
</div>
<div class="paragraph">
<p>Das Triplet wird zusammen mit der Beschreibung in Auswahllisten und der Konnektor- und Kartenansicht angezeigt (siehe Abbildung).</p>
</div>
<div class="sect2">
<h3 id="_default_kontext_empfehlung"><a class="anchor" href="#_default_kontext_empfehlung"></a>Default-Kontext (Empfehlung)</h3>
<div class="paragraph">
<p>Ein Default-Kontext, der alle Informationen abfragen darf erleichtert die Konfiguration in Cocard erheblich:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Auf dem Konnektor legt man einen Mandanten <code>cocard</code>, ein Clientsystem <code>cocard</code> und einen Default-Arbeitsplatz <code>Konnektor</code> an.</p>
</li>
<li>
<p>Der Mandant <code>cocard</code> bekommt alle SMB-Cs zugeordnet, sowie den Arbeitsplatz <code>Konnektor</code> unter dem Client <code>cocard</code>.</p>
</li>
<li>
<p>Alle Kartenterminals ordnet man dann dem Arbeitsplatz <code>Konnektor</code> zu.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Mit dem Kontext <code>cocard - cocard - Konnektor</code> kann Cocard jetzt alle Terminals und alle Karten abfragen.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Hinweis"></i>
</td>
<td class="content">
Der Kontext <code>cocard - cocard - Konnektor</code> sollte in Cocard immer nur dem Konnektor, nie einer SMC-B zugeordnet werden.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kontexte_eines_konnektors"><a class="anchor" href="#_kontexte_eines_konnektors"></a>Kontexte eines Konnektors</h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="../_images/context/connector-assigned-contexts.png" alt="connector assigned contexts">
</div>
<div class="title">Abbildung 1. Zugewiesene Kontexte eines Konnektors</div>
</div>
<div class="paragraph">
<p>Für einige Operationen verwendet Cocard nur den ersten Kontext. Der erste Kontext sollte daher derjenige sein, mit dem Cocard nach Möglichkeit alle Informationen abrufen kann. Für die Abfrage aller Kartenterminals und aller Karten werden alle hinterlegten Kontexte genutzt, damit Cocard alle Informationen abfragen kann, auch wenn der Default-Kontext nicht global über alles berechtigt wurde.</p>
</div>
<div class="paragraph">
<p>Die Reihenfolge kann durch einfaches Drag and Drop mit der Maus verändert werden, wenn der Benutzer die entsprechenden Berechtigungen für das Konnektor-Management hat.
Mit dem Button beim Kontextseintrag kann man prüfen, ob der Kontext auch auf dem Konnektor vorhanden ist:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/context/connector-context-check.png" alt="connector context check">
</div>
</div>
<div class="paragraph">
<p>Bei zertifikatsbasierter Authentifikation ist ein zum Clientsystem gehöriges Zertifikat erforderlich, das auch auf dem Konnektor dazu hinterlegt ist.
Klappt die Authentifikation nicht, liefert der Kontext-Check eine entsprechende Fehlermeldung:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/context/connector-context-check-auth-failure.png" alt="connector context check auth failure">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kontexte_einer_smc_b"><a class="anchor" href="#_kontexte_einer_smc_b"></a>Kontexte einer SMC-B</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">Zugewiesene Kontexte einer SMC-B Karte</div>
<p><span class="image"><img src="../_images/context/card-assigned-contexts.png" alt="card assigned contexts"></span></p>
</div>
<div class="paragraph">
<p>Für jeden Kontext, der einer SMC-B zugeordnet führt Cocard mit jeder Kartenabfrage auch eine PIN-Status-Prüfung durch. Der PIN-Status aller Kontexte muss ok sein, nur dann kann der Gesamtstatus der Karte auch mit OK gekennzeichnet werden. Im Umkehrschluss bedeutet das: nur die tatsächlich benötigten Kontexte sollten einer SMC-B zugeordnet sein. Hilfskontexte wie <code>cocard - cocard - Konnektor</code>, die in erster Linie der Informationsgewinnung dienen, mit denen aber keine produktiven kryptographischen Operationen ausgeführt werden, sollten nie bei einer SMC-B eingetragen sein.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kontext_anzeige_und_zugeordnete_objekte"><a class="anchor" href="#_kontext_anzeige_und_zugeordnete_objekte"></a>Kontext-Anzeige und zugeordnete Objekte</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In der Anzeige des Kontextes finden sich eine Übersicht von SMC-B-Karten und Konnektoren, die diesen Kontext nutzen.</p>
</div>
<div class="paragraph">
<div class="title">Anzeige eines Kontextes mit Beziehungen</div>
<p><span class="image"><img src="../_images/context/context-show.png" alt="context show"></span></p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="../user/logs.html">Event Logs</a></span>
  <span class="next"><a href="../user/acknowledges.html">Notizen und Acknowledges</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <span>Wolfgang Barth (C) 2024-2026</span>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/medium-zoom.min.js"></script>
<script>mediumZoom('img:not(.copy-icon');</script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/vendor/lunr-languages.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
